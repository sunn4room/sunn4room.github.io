(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{536:function(t,s,a){t.exports=a.p+"assets/img/mysql.e22fccc5.svg"},537:function(t,s,a){t.exports=a.p+"assets/img/InnoDB-major.eb327e01.svg"},538:function(t,s,a){t.exports=a.p+"assets/img/InnoDB-minor.57218b25.svg"},539:function(t,s,a){t.exports=a.p+"assets/img/MyISAM.8365cffd.svg"},676:function(t,s,a){"use strict";a.r(s);var r=a(52),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p",[t._v("mysql")]),t._v(" "),r("h2",{attrs:{id:"架构设计"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#架构设计"}},[t._v("#")]),t._v(" 架构设计")]),t._v(" "),r("p",[r("img",{attrs:{src:a(536),alt:""}})]),t._v(" "),r("h2",{attrs:{id:"配置文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),r("div",{staticClass:"language-ini extra-class"},[r("pre",{pre:!0,attrs:{class:"language-ini"}},[r("code",[r("span",{pre:!0,attrs:{class:"token selector"}},[t._v("[mysqld]")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token constant"}},[t._v("port")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token attr-value"}},[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" _port")]),t._v("\n\n")])])]),r("h2",{attrs:{id:"命令行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#命令行"}},[t._v("#")]),t._v(" 命令行")]),t._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[t._v("$ mysql -h _host -u _user -p\n")])])]),r("h2",{attrs:{id:"sql-语句"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#sql-语句"}},[t._v("#")]),t._v(" SQL 语句")]),t._v(" "),r("h3",{attrs:{id:"insert-into"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#insert-into"}},[t._v("#")]),t._v(" INSERT INTO")]),t._v(" "),r("h3",{attrs:{id:"delete-from"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#delete-from"}},[t._v("#")]),t._v(" DELETE FROM")]),t._v(" "),r("h3",{attrs:{id:"update"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[t._v("#")]),t._v(" UPDATE")]),t._v(" "),r("h3",{attrs:{id:"select"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#select"}},[t._v("#")]),t._v(" SELECT")]),t._v(" "),r("div",{staticClass:"language-sql extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sql"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("select_list"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("table1"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("join_type"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("table2"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("join_condition"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("where_condition"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("group_by_list"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("having_condition"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("order_by_list"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("limit_num"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-------- 机读顺序 ---------")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- FROM <table1>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ON <join_condition>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- <join_type> JOIN <table2>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- WHERE <where_condition>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- GROUP BY <group_by_list>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- HAVING <having_condition>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- SELECT <select_list>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ORDER BY <order_by_list>")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- LIMIT <limit_num>")]),t._v("\n")])])]),r("h4",{attrs:{id:"连接"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#连接"}},[t._v("#")]),t._v(" 连接")]),t._v(" "),r("p",[t._v("MySQL 支持全连接、内连接、左连接、右连接")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("type")]),t._v(" "),r("th",[t._v("描述")]),t._v(" "),r("th",[t._v("驱动")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v(", xxx")]),t._v(" "),r("td",[t._v("全连接")]),t._v(" "),r("td",[t._v("左表驱动右表")])]),t._v(" "),r("tr",[r("td",[t._v("inner join xxx on xxx")]),t._v(" "),r("td",[t._v("内连接")]),t._v(" "),r("td",[t._v("小表驱动大表")])]),t._v(" "),r("tr",[r("td",[t._v("left join xxx on xxx")]),t._v(" "),r("td",[t._v("左连接")]),t._v(" "),r("td",[t._v("左表驱动右表")])]),t._v(" "),r("tr",[r("td",[t._v("right join xxx on xxx")]),t._v(" "),r("td",[t._v("右连接")]),t._v(" "),r("td",[t._v("右表驱动左表")])])])]),t._v(" "),r("h4",{attrs:{id:"小表驱动大表"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#小表驱动大表"}},[t._v("#")]),t._v(" 小表驱动大表")]),t._v(" "),r("div",{staticClass:"language-sql extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sql"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- a > b")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" a "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" a"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" id "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" b"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- a < b")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" a "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exists")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" b "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" b"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),r("h4",{attrs:{id:"慢查询日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#慢查询日志"}},[t._v("#")]),t._v(" 慢查询日志")]),t._v(" "),r("h3",{attrs:{id:"index"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#index"}},[t._v("#")]),t._v(" INDEX")]),t._v(" "),r("p",[t._v("索引是为了提高查询效率而设计的一种特殊的数据结构。MySQL 主要用的是 B+Tree。")]),t._v(" "),r("ul",[r("li",[t._v("B+Tree 可以有效减少磁盘 IO")]),t._v(" "),r("li",[t._v("B+Tree 可以提供高效的范围查询")])]),t._v(" "),r("h4",{attrs:{id:"索引类型"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#索引类型"}},[t._v("#")]),t._v(" 索引类型")]),t._v(" "),r("h4",{attrs:{id:"索引失效"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#索引失效"}},[t._v("#")]),t._v(" 索引失效")]),t._v(" "),r("ul",[r("li",[t._v("函数、计算、类型转换")]),t._v(" "),r("li",[t._v("范围条件")]),t._v(" "),r("li",[t._v("不等于 "),r("code",[t._v("<>")]),t._v(" "),r("code",[t._v("!=")])]),t._v(" "),r("li",[r("code",[t._v("is null")]),t._v(" "),r("code",[t._v("is not null")])]),t._v(" "),r("li",[r("code",[t._v("like '%abcd'")])]),t._v(" "),r("li",[r("code",[t._v("or")])])]),t._v(" "),r("h3",{attrs:{id:"系统配置语句"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#系统配置语句"}},[t._v("#")]),t._v(" 系统配置语句")]),t._v(" "),r("div",{staticClass:"language-sql extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sql"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SHOW")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GLOBAL")]),t._v(" VARIABLES"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 查看所有变量")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" @"),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@_global")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("variable"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 查看单个变量")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GLOBAL")]),t._v(" _global"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("variable"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("name"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("XXX"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 设置变量值")]),t._v("\n")])])]),r("h3",{attrs:{id:"系统内置函数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#系统内置函数"}},[t._v("#")]),t._v(" 系统内置函数")]),t._v(" "),r("h2",{attrs:{id:"查询优化"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查询优化"}},[t._v("#")]),t._v(" 查询优化")]),t._v(" "),r("h3",{attrs:{id:"explain"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#explain"}},[t._v("#")]),t._v(" EXPLAIN")]),t._v(" "),r("p",[t._v("用于分析 SELECT 语句的执行情况")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("字段名")]),t._v(" "),r("th",[t._v("描述")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("id")]),t._v(" "),r("td",[t._v("表示执行顺序，相同时自上而下，不相同时大者优先。起始为 1")])]),t._v(" "),r("tr",[r("td",[t._v("select_type")]),t._v(" "),r("td",[t._v("表示查询类型。"),r("br"),r("strong",[t._v("SIMPLE")]),t._v(" 简单查询（不包含子查询和 union）"),r("br"),r("strong",[t._v("PRIMARY")]),t._v(" 主查询"),r("br"),r("strong",[t._v("SUBQUERY")]),t._v(" 子查询"),r("br"),r("strong",[t._v("DERIVED")]),t._v(" 临时表查询"),r("br"),r("strong",[t._v("UNION")]),t._v(" 联合查询"),r("br"),r("strong",[t._v("UNION RESULT")]),t._v(" 联合结果查询")])]),t._v(" "),r("tr",[r("td",[t._v("table")]),t._v(" "),r("td",[t._v("查询所针对的表，如果是临时表，则会被命名为 derived<id>")])]),t._v(" "),r("tr",[r("td",[t._v("type")]),t._v(" "),r("td",[t._v("表示表访问类型。"),r("br"),r("strong",[t._v("system")]),t._v(" 全表只有一行，多出现在 mysql 的系统表里"),r("br"),r("strong",[t._v("const")]),t._v(" 查询用到主键或唯一索引，且条件是一个常量"),r("br"),r("strong",[t._v("eq_ref")]),t._v(" 查询用到主键或唯一索引，但条件不是一个常量"),r("br"),r("strong",[t._v("ref")]),t._v(" 查询用到非唯一性索引"),r("br"),r("strong",[t._v("range")]),t._v(" 查询用到了索引，但条件是范围查询"),r("br"),r("strong",[t._v("index")]),t._v(" 全索引扫描"),r("br"),r("strong",[t._v("ALL")]),t._v(" 全表扫描")])]),t._v(" "),r("tr",[r("td",[t._v("possible_key")]),t._v(" "),r("td",[t._v("可能用到的索引")])]),t._v(" "),r("tr",[r("td",[t._v("key")]),t._v(" "),r("td",[t._v("实际用到的索引")])]),t._v(" "),r("tr",[r("td",[t._v("key_len")]),t._v(" "),r("td",[t._v("索引扫描的可能字节数")])]),t._v(" "),r("tr",[r("td",[t._v("ref")]),t._v(" "),r("td",[t._v("查询条件的引用类型。const 常量")])]),t._v(" "),r("tr",[r("td",[t._v("rows")]),t._v(" "),r("td",[t._v("可能扫描的行数")])]),t._v(" "),r("tr",[r("td",[t._v("Extra")]),t._v(" "),r("td",[t._v("额外信息。"),r("br"),r("strong",[t._v("using filesort")]),t._v(" 文件内排序，表示没有用到索引中的排序结果"),r("br"),r("strong",[t._v("using temporary")]),t._v(" 使用了临时内存表"),r("br"),r("strong",[t._v("using index")]),t._v(" 使用了覆盖索引"),r("br"),r("strong",[t._v("using where")]),t._v(" 使用了索引进行查找")])])])]),t._v(" "),r("h3",{attrs:{id:"show-profiles"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#show-profiles"}},[t._v("#")]),t._v(" SHOW PROFILES")]),t._v(" "),r("p",[t._v("分析语句执行的资源损耗情况")]),t._v(" "),r("h2",{attrs:{id:"锁-innodb"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#锁-innodb"}},[t._v("#")]),t._v(" 锁（InnoDB）")]),t._v(" "),r("h3",{attrs:{id:"共享锁和拍他锁"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#共享锁和拍他锁"}},[t._v("#")]),t._v(" 共享锁和拍他锁")]),t._v(" "),r("p",[t._v("InnoDB 实现了行级的共享锁和排他锁，读与读共享，读与写、写与写排他。")]),t._v(" "),r("h2",{attrs:{id:"事务-innodb"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#事务-innodb"}},[t._v("#")]),t._v(" 事务（InnoDB）")]),t._v(" "),r("blockquote",[r("p",[t._v("事务的四大特性 (ACID)")]),t._v(" "),r("ul",[r("li",[t._v("atomicity，即原子性，事务中的所有操作要么全部执行，要么全部不执行，不予许在中间停滞")]),t._v(" "),r("li",[t._v("consistency，即一致性，事务前后要保证数据的完整无误")]),t._v(" "),r("li",[t._v("isolation，即隔离性，事务的执行不能被其他并行的事务干扰")]),t._v(" "),r("li",[t._v("durability，即持久性，事务一旦提交，对数据的改变是永久的，否则事务将毫无意义")])])]),t._v(" "),r("h3",{attrs:{id:"原子性的实现"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#原子性的实现"}},[t._v("#")]),t._v(" 原子性的实现")]),t._v(" "),r("p",[t._v("原子性包含了持久性，为了避免歧义，一般原子性指的是异常回滚。MySQL 为每一行记录维护了一个 Undo log 的版本链，当执行异常时，可以通过 Undo log 回滚到初始状态。")]),t._v(" "),r("blockquote",[r("p",[t._v("Undo log 的底层原理是 MySQL 为每一张表都自动生成了两列数据，一列是事务 ID，一列是 Undo 指针，所以版本链中的每一个节点其实都是表中存着的记录，只不过有些记录你看不到而已，随着时间的推移，会把无用的版本链节点删除。")])]),t._v(" "),r("h3",{attrs:{id:"隔离性的实现"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#隔离性的实现"}},[t._v("#")]),t._v(" 隔离性的实现")]),t._v(" "),r("p",[t._v("Undo log 维护的事务 ID 以及系统自身维护的激活事务列表可以用来实现隔离算法。InnoDB 提供了对隔离性的完美支持，一共有四种隔离级别：")]),t._v(" "),r("ul",[r("li",[r("strong",[t._v("未提交读")]),t._v("：不隔离，直接读取版本链的第一条记录")]),t._v(" "),r("li",[r("strong",[t._v("提交读")]),t._v("：事务内每次 SELECT 前会先得到激活事务 ID 列表和最大事务 ID，后面简称“快照”，然后从版本链的第一条记录开始，直到找到一个事务 ID 小于等于最大事务 ID 且不在激活事务 ID 列表里的记录。")]),t._v(" "),r("li",[r("strong",[t._v("可重复读")]),t._v("：事务内第一次 SELECT 会生成“快照”，随后的 SELECT 会沿用第一次生成的“快照”找记录。")]),t._v(" "),r("li",[r("strong",[t._v("串行化")]),t._v("：最严格的隔离级别，事务内每个 SELECT 都会给目标记录上锁，从而阻塞其他事务对同一目标记录的操作。")])]),t._v(" "),r("blockquote",[r("p",[r("strong",[t._v("隔离性与锁")])])]),t._v(" "),r("h3",{attrs:{id:"持久性的实现"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#持久性的实现"}},[t._v("#")]),t._v(" 持久性的实现")]),t._v(" "),r("p",[t._v("事务提交前，会先记录 Redo log 之后再进行真正的数据修改，这样当数据修改发生故障，还可以通过 Redo log 在下一次启动时修复故障带来的影响。")]),t._v(" "),r("blockquote",[r("p",[r("strong",[t._v("原子性、隔离性和持久性都是为了实现一致性")])])]),t._v(" "),r("h2",{attrs:{id:"日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[t._v("#")]),t._v(" 日志")]),t._v(" "),r("h3",{attrs:{id:"错误日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#错误日志"}},[t._v("#")]),t._v(" 错误日志")]),t._v(" "),r("ul",[r("li",[t._v("log_error：错误日志的存放路径")]),t._v(" "),r("li",[t._v("log_warnings：表示是否记录告警信息到错误日志，0表示不记录告警信息，1表示记录告警信息，大于1表示各类告警信息")])]),t._v(" "),r("h3",{attrs:{id:"普通查询日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#普通查询日志"}},[t._v("#")]),t._v(" 普通查询日志")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("general_log：表示查询日志是否开启")])]),t._v(" "),r("li",[r("p",[t._v("log_output：以哪种方式存放。"),r("code",[t._v("FILE")]),t._v("表示存放于文件中，"),r("code",[t._v("TABLE")]),t._v("表示存放于表mysql.general_log中")]),t._v(" "),r("blockquote",[r("p",[t._v("同样适用于慢查询，"),r("code",[t._v("TABLE")]),t._v("表示存放于表 mysql.slow_log")])])]),t._v(" "),r("li",[r("p",[t._v("general_log_file：表示查询日志存放于文件的路径")])])]),t._v(" "),r("h3",{attrs:{id:"慢查询日志-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#慢查询日志-2"}},[t._v("#")]),t._v(" 慢查询日志")]),t._v(" "),r("ul",[r("li",[t._v("slow_query_log：表示查询日志是否开启")]),t._v(" "),r("li",[t._v("slow_query_log_file：表示查询日志存放于文件的路径")]),t._v(" "),r("li",[t._v('long_query_time：表示多长时间的查询被认为"慢查询"，默认10s')])]),t._v(" "),r("h3",{attrs:{id:"二进制日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二进制日志"}},[t._v("#")]),t._v(" 二进制日志")]),t._v(" "),r("ul",[r("li",[t._v("log_bin：表示二进制日志是否开启")]),t._v(" "),r("li",[t._v("log_bin_basename：二进制日志文件前缀名，其中包含路径")]),t._v(" "),r("li",[t._v("max_binlog_size：二进制日志文件的最大大小，超过此大小，二进制文件会自动滚动")]),t._v(" "),r("li",[t._v("log_bin_index：二进制日志文件索引文件名")]),t._v(" "),r("li",[t._v("binlog_format：决定了二进制日志的记录方式\n"),r("ul",[r("li",[r("code",[t._v("STATEMENT")]),t._v("以语句的形式记录，日志量少但不能保证完全恢复数据")]),t._v(" "),r("li",[r("code",[t._v("ROW")]),t._v("以数据修改的形式记录，日志量大但可以保证数据完全恢复")])])])]),t._v(" "),r("div",{staticClass:"language-sh extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[t._v("$ mysqlbinlog _log_bin_basename.000001\n$ mysqlbinlog --start-position"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("XXX --stop-position"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("XXX _log_bin_basename.000001 "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" recover_file.sql\n")])])]),r("div",{staticClass:"language-sql extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sql"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#临时关闭binlog")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" sql_log_bin"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#执行sql文件")]),t._v("\nsource recover_file"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#开启binlog")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" sql_log_bin"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),r("h2",{attrs:{id:"存储原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#存储原理"}},[t._v("#")]),t._v(" 存储原理")]),t._v(" "),r("h3",{attrs:{id:"innodb"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#innodb"}},[t._v("#")]),t._v(" InnoDB")]),t._v(" "),r("h4",{attrs:{id:"聚集索引"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#聚集索引"}},[t._v("#")]),t._v(" 聚集索引")]),t._v(" "),r("p",[r("img",{attrs:{src:a(537),alt:""}})]),t._v(" "),r("h4",{attrs:{id:"辅助索引"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#辅助索引"}},[t._v("#")]),t._v(" 辅助索引")]),t._v(" "),r("p",[r("img",{attrs:{src:a(538),alt:""}})]),t._v(" "),r("h3",{attrs:{id:"myisam"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#myisam"}},[t._v("#")]),t._v(" MyISAM")]),t._v(" "),r("h4",{attrs:{id:"非聚集索引"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#非聚集索引"}},[t._v("#")]),t._v(" 非聚集索引")]),t._v(" "),r("p",[r("img",{attrs:{src:a(539),alt:""}})]),t._v(" "),r("h2",{attrs:{id:"集群"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#集群"}},[t._v("#")]),t._v(" 集群")])])}),[],!1,null,null,null);s.default=e.exports}}]);